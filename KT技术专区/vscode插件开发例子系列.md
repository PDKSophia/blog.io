# èƒŒæ™¯


> ğŸ“¢ åšå®¢é¦–å‘ : [é˜¿å®½çš„åšå®¢](https://github.com/PDKSophia/blog.io)

> ğŸ“¢ å›¢é˜Ÿåšå®¢: [SugarTurboS](https://github.com/SugarTurboS/Blogs)

> ğŸŒˆ ä»“åº“æºç  : [learn-vscode-extension](https://github.com/PDKSophia/learn-vscode-extension) ï¼Œæ±‚ä¸ª âœ¨ star


å¥½ä¹…ä¸è§ï¼Œæ•´äº†ä¸€ä¸ªæœˆçš„`Electron+React+Nodeå®ç°é¡¹ç›®è¾…åŠ©å·¥å…·`å¥½ä¸å®¹æ˜“æå®Œäº†ï¼Œç„¶ååœ¨é¡¹ç›®ç»„é‡Œæ¨å¹¿ï¼Œç»è¿‡ä¸€å‘¨åœ¨å›¢é˜Ÿå†…éƒ¨ä½¿ç”¨ï¼Œä½¿ç”¨æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œæ— äººé—®æ´¥ï¼Œç»è¿‡åé¦ˆï¼ŒåŸå› åœ¨äºç»„å‘˜æ›´å¤šæ“ä½œè¿˜æ˜¯åœ¨ vscode ä¸­å®Œæˆï¼Œ è¿™å°±å¾ˆè›‹ç–¼äº†ï¼Œéƒ½æ˜¯ç»™ vscode æƒ¯çš„ï¼Œå¥½å®¶ä¼™ï¼Œå‘ vscode ä½å¤´ï¼Œäºæ˜¯æˆ‘å°è¯•è¿™ä¸ªé¡¹ç›®è¾…åŠ©å·¥å…·åšåˆ° vscode æ’ä»¶ä¸­ï½

âš ï¸ è¯·æ³¨æ„ï¼šè¿™ç¯‡æ–‡ç« æ˜¯è¯´æ˜åœ¨å¼€å‘ vscode æ’ä»¶æ—¶çš„ä¸€äº›å‘ä»¥åŠ demo çš„ä¾‹å­ï¼Œè‡³äº`Electron+React+Nodeå®ç°é¡¹ç›®è¾…åŠ©å·¥å…·`ç³»åˆ—æ–‡ç« åœ¨å‡†å¤‡ä¸­ï¼Œè¿˜æœ‰æœ€ç»ˆå®è·µè½åœ°çš„ vscode å®æˆ˜æ’ä»¶æ–‡ç« ä¹Ÿèººåœ¨è‰ç¨¿ç®±é‡Œ

# åæ§½ä¸€ä¸‹

æˆ‘æ€€ç–‘æˆ‘æ˜¯è¢«â€œæâ€äº†ï¼Œæœ¬æ¥è¿™ä¸ªé¡¹ç›®è¾…åŠ©å·¥å…·ä½¿ç”¨ `Electron` å¼€å‘æ—¶ï¼Œæˆ‘å°±è§‰å¾—è¿™æ˜¯ä¸ªå‘ï¼Œæ¯•ç«Ÿæˆ‘æ²¡å†™è¿‡ electronï¼Œç­‰æˆ‘åšå®Œäº†ä¹‹åï¼Œå¥½å®¶ä¼™ï¼Œè·Ÿæˆ‘è¯´:â€œè¿˜éœ€è¦ä¸‹è½½ä¸ª PC åŒ…å®‰è£…ï¼Œå†è¿è¡Œåº”ç”¨ï¼Ÿâ€ï¼Œâ€œæ“ä½œç¹çâ€ï¼Œè®©æˆ‘åšä¸ª vscode æ’ä»¶

vscode æ’ä»¶æˆ‘ä¹Ÿæ²¡æè¿‡å•Šï¼Œè¿™æ˜¯è®©æˆ‘â€œè¿éš¾(ç”·)è€Œä¸Šâ€äº†ï¼å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥å¼€å§‹å§ã€‚ æ€ä¹ˆè¯´å‘¢ï¼Œåœ¨åšä¹‹å‰ï¼Œä¹Ÿåœ¨ç½‘ä¸Šæœè¿‡ä¸€äº›æ–‡ç« ï¼Œå¥ˆä½•å¤§éƒ¨åˆ†éƒ½åœç•™åœ¨ **install + hello world** é˜¶æ®µï¼Œæ„æ€å°±æ˜¯æ•™ä½ å¦‚ä½•å®‰è£…ï¼Œç„¶åå†™ä¸€ä¸ª hello world ç®€å•çš„å° demoï¼Œå½“ç„¶ï¼Œè¿™ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†è¿™å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œ**æˆ‘æƒ³è¦çš„æ˜¯éœ€è¦å„ç§åœºæ™¯ä¸‹çš„ demo ä¾‹å­**ï¼Œç»è¿‡ä¸€äº›æ–‡ç« çš„æŸ¥æ‰¾å’Œç¿»é˜…å®˜æ–¹æ–‡æ¡£ï¼Œ[æ•´ç†äº†ä¸€äº›å¸¸è§çš„ä¾‹å­](https://github.com/PDKSophia/learn-vscode-extension)ï¼Œåç»­ä¼šæŒç»­æ›´æ–°ï¼ŒåŒ…æ‹¬é¡¹ç›®æœ€ç»ˆè½åœ°çš„ vscode å®æˆ˜æ’ä»¶ç­‰ï½

# åˆæ­¥å°è¯•

## ä¸€ã€å®‰è£…ä¾èµ–

å¾®è½¯ä¸ºäº†é€ ç¦å¤§ä¼—ï¼Œæä¾›äº†ä¸€ä¸ª `yeoman` è„šæ‰‹æ¶ï¼Œé€šè¿‡æ­¤è„šæ‰‹æ¶å¯ä»¥ç”Ÿæˆå¼€å‘æ’ä»¶çš„æ¨¡ç‰ˆä»£ç ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è¿›è¡Œå®‰è£…

```bash
npm install -g yo generator-code
```

è¿™æ—¶å€™ä½ åº”è¯¥æ˜¯æœ‰ä¸€ä¸‹ç¯å¢ƒçš„

- nodejs
- npm
- yeoman
- generator-code

## äºŒã€åˆå§‹åŒ– Demo æ’ä»¶

å½“ä¸Šé¢çš„å®‰è£…å®Œæ¯•ä¹‹åï¼Œåªéœ€è¦è¿›å…¥ä½ å¼€å‘ç›®å½•æ–‡ä»¶å¤¹ï¼Œé€šè¿‡è„šæ‰‹æ¶ç”Ÿæˆä¸€ä¸ªå¼€å‘ vscode æ’ä»¶çš„é¡¹ç›®ã€‚

```bash
yo code
```

æ ¹æ®æç¤ºä¿¡æ¯å¡«å†™ç›¸å…³å†…å®¹

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f50d78d466d4206802f2f0fcd801d66~tplv-k3u1fbpfcp-watermark.image)

è¿™æ—¶å€™æˆ‘ä»¬çš„ vscode æ’ä»¶é¡¹ç›®å°±å®Œæˆåˆå§‹åŒ–äº†ï½ ä¸‹é¢çœ‹çœ‹ç›¸å…³æ–‡ä»¶çš„è¯´æ˜ï¼

## æ–‡ä»¶è¯´æ˜

é¡¹ç›®ä¸­ä¸¤ä¸ªé‡è¦çš„æ–‡ä»¶æˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹ï¼š**extension.ts** å’Œ **package.json**

### 3.1 extension.ts

è¯¥æ–‡ä»¶æ˜¯å…¥å£æ–‡ä»¶ï¼Œä¸‹é¢æˆ‘ä»¬å†™ä¸€æ®µç®€å•çš„ demo ä»£ç 

æ­¤æ®µä»£ç æ„æ€ä¸ºï¼šæ³¨å†Œä¸€ä¸ª beehive.toastDemo äº‹ä»¶ï¼Œå½“è§¦å‘æ­¤äº‹ä»¶ä¼šæ˜¾ç¤ºä¸€æ®µ message

```typescript
// extension.ts
import * as vscode from 'vscode'
export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  let disposable = vscode.commands.registerCommand('beehive.toastDemo', () => {
    vscode.window.showInformationMessage('toastDemo touched !')
  })
  context.subscriptions.push(disposable)
}
export function deactivate() {}
```

### 3.2 package.json

è¯¥æ–‡ä»¶é…ç½®é¡¹å¤ªå¤šï¼Œå»ºè®®å»å®˜æ–¹æ–‡æ¡£ç¿»é˜…

å…³é”®çš„ä¸»è¦æ˜¯: **activationEvents** å’Œ **contributes** è¿™ä¸¤ä¸ªå±æ€§ï¼Œå…³äºè¿™ä¸¤ä¸ªå±æ€§ä½ å¯ä»¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://code.visualstudio.com/api/references/contribution-points)

ä¸‹é¢è®²ä¸€ä¸‹ contributes è¿™ç©æ„ï¼Œcontributes æ˜¯è¿™ä¸ªæ’ä»¶çš„æ ¸å¿ƒï¼ŒæŒ‡ä»£è¿™ä¸ªæ’ä»¶æœ‰å“ªäº›åŠŸèƒ½ã€‚é€šè¿‡å®˜æ–¹æ–‡æ¡£æˆ‘ä»¬ä¹Ÿèƒ½çŸ¥é“(è¿™äº›éƒ½åœ¨[demo ä¾‹å­](https://github.com/PDKSophia/learn-vscode-extension/issues)ä¸­æœ‰å†™åˆ°)ï¼š

- configurationï¼šé€šè¿‡è¿™ä¸ªé…ç½®é¡¹æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥åœ¨ vscode çš„ settings.json ä¸­è®¾ç½®ï¼Œç„¶ååœ¨æ’ä»¶å·¥ç¨‹ä¸­å¯ä»¥è¯»å–ç”¨æˆ·è®¾ç½®çš„è¿™ä¸ªå€¼ï¼Œè¿›è¡Œç›¸åº”çš„é€»è¾‘ã€‚
- commandsï¼šå®šä¹‰çš„å‘½ä»¤ï¼Œåœ¨ vscode ä¸­é€šè¿‡ `cmd+shift+p` è¿›è¡Œè¾“å…¥å®šä¹‰å¥½çš„å‘½ä»¤å°±å¯è§¦å‘å¯¹åº”äº‹ä»¶ã€‚
- menusï¼šè‡ªå®šä¹‰ç¼–è¾‘å™¨å³ä¾§èœå•æ 
- keybindingsï¼šå¯ä»¥è®¾ç½®å¿«æ·é”®
- languagesï¼šè®¾ç½®è¯­è¨€ç‰¹ç‚¹ï¼ŒåŒ…æ‹¬è¯­è¨€çš„åç¼€ç­‰
- grammarsï¼šå¯ä»¥åœ¨è¿™ä¸ªé…ç½®é¡¹é‡Œè®¾ç½®æè¿°è¯­è¨€çš„è¯­æ³•æ–‡ä»¶çš„è·¯å¾„ï¼Œvscode å¯ä»¥æ ¹æ®è¿™ä¸ªè¯­æ³•æ–‡ä»¶æ¥è‡ªåŠ¨å®ç°è¯­æ³•é«˜äº®åŠŸèƒ½
- snippetsï¼šè®¾ç½®è¯­æ³•ç‰‡æ®µç›¸å…³çš„è·¯å¾„

ä»¥ä¸Šè¾¹æ³¨å†Œçš„ `toastDemo` ä¸ºä¾‹ï¼Œæ­¤æ—¶çš„ package.json åº”ä¸ºï¼š

```json
{
  "activationEvents": ["onCommand:beehive.toastDemo"],
  "contributes": {
    "commands": [
      {
        "command": "beehive.toastDemo",
        "title": "demo1: beehive.toastDemo !"
      }
    ]
  }
}
```

## å››ã€è¿è¡Œ vscode æ’ä»¶

ç‚¹å‡»æ­¤ Debug Iconï¼Œæˆ–è€…æ˜¯ vscode èœå•æ ï¼šRun -> Start Debugging

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f292b39e2eac47a9800df5cf266f264b~tplv-k3u1fbpfcp-watermark.image" width=320 />

å½“æˆ‘ä»¬ç‚¹å‡»ä¸‹ Run Extension æ—¶ï¼Œä¼šå¼€ä¸€ä¸ªæœ¬åœ° vscode çª—å£

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5038b137ee948f1a725f7b9e95dd8e1~tplv-k3u1fbpfcp-watermark.image" width=450 />

æˆ‘ä»¬åœ¨æ–°å¼€çš„ vscode çª—å£ä¸­è¾“å…¥ : `cmd + shift + P`

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aeb375687ab9407195311cfc25d2a1b6~tplv-k3u1fbpfcp-watermark.image" width=400 />

ç„¶åè¾“å…¥æˆ‘ä»¬æ³¨å†Œçš„äº‹ä»¶ï¼š`beehive.toastDemo`ï¼Œç„¶åæˆ‘ä»¬æŒ‰ä¸‹å›è½¦ï¼Œå°±ä¼šæ‰§è¡Œæˆ‘ä»¬å†™çš„äº‹ä»¶å›è°ƒäº†ï¼

<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e2da6a965544aedb5b36a607624a3f0~tplv-k3u1fbpfcp-watermark.image" width=360 />

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç®€å• Demo å®Œæˆï¼å¦‚æœä½ è¿˜ä¸äº†è§£ï¼Œ[ğŸ‘‰ å»ºè®®ç›´æ¥å»çœ‹æºç ï¼Œç‰¹åˆ«ç®€å•](https://github.com/PDKSophia/learn-vscode-extension/issues)

# ä¾‹å­

æˆ‘å†™ä¸ª vscode æ’ä»¶ï¼Œè‚¯å®šä¸åªæ˜¯æƒ³å±•ç¤ºä¸€ä¸ª `toastMessage` å¼¹çª—å§ ï¼Ÿï¼Ÿï¼Ÿæˆ‘æƒ³åšäº›äº¤äº’æ•ˆæœå’‹åŠï¼Œæƒ³è‡ªå®šä¹‰ Menuã€æƒ³å±•ç¤º WebViewã€æƒ³è‡ªå®šä¹‰å·¦ä¾§ä¾§è¾¹æ å’‹æ•´ï¼Ÿï¼Ÿä¸æ…Œï¼Œå¾€ä¸‹çœ‹ï¼Œä¸‹é¢æ˜¯æˆ‘æ•´ç†çš„ä¸€äº›å° demoï¼Œè™½ç„¶ä¸ä¸€å®šèƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½†æ˜¯å¸Œæœ›åº”è¯¥èƒ½ç»™ä½ ä¸€äº›å¸®åŠ©ï½

## 1.è¾“å…¥å†…å®¹(Input)

### åœºæ™¯

è¯¥åœºæ™¯é€‚åˆä¸€äº›éœ€è¦è¾“å…¥å†…å®¹ä¹‹ååšçš„æ“ä½œï¼›

- è¾“å…¥ text ï¼Œå‘èµ·æ¥å£è¯·æ±‚ç­‰
- è¾“å…¥ text ï¼Œæ‰§è¡Œä¸€äº›é€»è¾‘æ“ä½œ
- ......

### ä»£ç å±•ç¤º

```typescript
// demo1 éœ€è¦Inputè¾“å…¥å†…å®¹
// beehive-inputName.ts
import * as vscode from 'vscode'

module.exports = function (context: vscode.ExtensionContext) {
  let disposable = vscode.commands.registerCommand('beehive.inputName', () => {
    vscode.window
      .showInputBox({
        ignoreFocusOut: true,
        password: false,
        prompt: 'entry your name',
      })
      .then((value) => {
        if (value === undefined || value.trim() === '') {
          vscode.window.showInformationMessage('Please type your name.')
        } else {
          const name = value.trim()
          vscode.window.showInformationMessage('your name is: ', name)
          return
        }
      })
  })

  context.subscriptions.push(disposable)
}
```

å…¥å£æ–‡ä»¶éœ€è¦å¼•å…¥è¯¥æ–‡ä»¶

```typescript
// extension.ts
import * as vscode from 'vscode'

export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  require('./beehive-inputName')(context) // demo1 è¾“å…¥Inputå†…å®¹
}

export function deactivate() {}
```

é€šè¿‡ package.json ä¹Ÿéœ€è¦æ³¨å†Œæ­¤äº‹ä»¶

```json
{
  "activationEvents": ["onCommand:beehive.inputName"],
  "contributes": {
    "commands": [
      {
        "command": "beehive.inputName",
        "title": "demo1: beehive.inputName !"
      }
    ]
  }
}
```

### æ•ˆæœå±•ç¤º

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5073c2589d4c49b8ad1675afdcd0794c~tplv-k3u1fbpfcp-watermark.image" width=420 />

### æºç å±•ç¤º

- [beehive-inputName.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-inputName.ts)

## 2.è‡ªå®šä¹‰ WebView é¡µé¢

### åœºæ™¯

è¯¥æ’ä»¶åœºæ™¯é€‚åˆåšä¸€äº›ç®€å•é¡µé¢å±•ç¤ºã€æ¬¢è¿é¡µé¢ç­‰

### ä»£ç å±•ç¤º

```typescript
// demo2 è‡ªå®šä¹‰æ˜¾ç¤ºé¡µ
// å…·ä½“çœ‹ package.json ä¸­çš„ configuration å’Œ commands
import * as vscode from 'vscode'
import * as fs from 'fs'
import * as path from 'path'

module.exports = function (context: vscode.ExtensionContext) {
  let disposable = vscode.commands.registerCommand(
    'beehive.customWelcome',
    () => {
      const panel = vscode.window.createWebviewPanel(
        'welcome',
        'è‡ªå®šä¹‰æ¬¢è¿é¡µ',
        vscode.ViewColumn.One,
        {
          enableScripts: true,
        }
      )

      const htmlPath = path.join(
        context.extensionPath,
        'src/customWelcome.html'
      )
      let html = fs.readFileSync(htmlPath, 'utf-8')
      panel.webview.html = html
    }
  )

  context.subscriptions.push(disposable)
}
```

```typescript
// extension.ts
import * as vscode from 'vscode'

export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  require('./beehive-customWelcome')(context) // demo2 åŠ è½½è‡ªå®šä¹‰WebViewæ¬¢è¿é¡µ
}

export function deactivate() {}
```

```json
// package.json
{
  "activationEvents": ["onCommand:beehive.customWelcome"],
  "contributes": {
    "commands": [
      {
        "command": "beehive.customWelcome",
        "title": "demo4: beehive.customWelcome !"
      }
    ]
  }
}
```

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è‡ªå®šä¹‰æ¬¢è¿é¡µé¢</title>
    <style>
      .app {
        margin: 12px 0;
        font-size: 24px;
      }
      .title {
        font-size: 18px;
        margin-top: 24px;
      }
    </style>
  </head>
  <body>
    <div class="app">
      Welcome BeeHiver ï½
      <div class="title">åäººå“€ä¹‹è€Œä¸é‰´ä¹‹ äº¦ä½¿åäººè€Œå¤å“€åäººä¹Ÿ !</div>
    </div>
    <img
      src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif"
      width="300"
    />
  </body>
</html>
```

### æ•ˆæœå±•ç¤º

<img src="https://user-images.githubusercontent.com/29560420/106861315-90af4a80-6700-11eb-83c6-976f8ee3d90d.png" width=400 />

### æºç å±•ç¤º

- [beehive-customWelcome.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-customWelcome.ts)

## 3.å¿«æ·é”®æ³¨å†Œ

### åœºæ™¯

æ¯æ¬¡æˆ‘ä»¬éƒ½éœ€è¦ cmd+shift + P è°ƒå‡ºé€‰æ‹©å™¨ï¼Œç„¶åè¾“å…¥æˆ‘ä»¬æ³¨å†Œçš„äº‹ä»¶åï¼Œç‰¹åˆ«éº»çƒ¦ï¼Œvscode æ”¯æŒå¿«æ·é”®æ³¨å†Œï¼Œä¸‹é¢çœ‹çœ‹å¦‚ä½•å®ç°å§ï¼

### ä»£ç å±•ç¤º

```json
{
  "activationEvents": ["onCommand:beehive.keybindings"],
  "contributes": {
    "commands": [
      {
        "command": "beehive.keybindings",
        "title": "demo4: beehive.keybindings !"
      }
    ],
    "keybindings": [
      {
        "command": "beehive.keybindings",
        "key": "Cmd+]",
        "mac": "Cmd+]",
        "when": "editorTextFocus"
      }
    ]
  }
}
```

ç„¶åæ­¤æ—¶æˆ‘ä»¬é€šè¿‡ `Run Extension` (ä¸Šé¢æœ‰è¯´å¦‚ä½•è¿è¡Œæ’ä»¶) ï¼Œåœ¨æœ¬åœ°çª—å£ï¼Œæˆ‘ä»¬éšä¾¿æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæŒ‰ä¸‹ : `cmd+]` å°±å¯ä»¥è§¦å‘æˆ‘ä»¬å®šä¹‰çš„ `beehive.keybindings` äº‹ä»¶

> ğŸ™‹â€â™‚ï¸ å¯èƒ½æœ‰äººè¦é—®ï¼Œä¸ºä»€ä¹ˆè¦æ‰“å¼€æ–‡ä»¶ï¼Ÿç›´æ¥æŒ‰å¿«æ·é”®ä¸ºä»€ä¹ˆæ²¡æœ‰ååº”ï¼ŸåŸå› æ˜¯ï¼šæˆ‘ä»¬ä¸Šé¢å†™äº† when æ¡ä»¶ï¼Œ**å½“ç¼–è¾‘å™¨è¢«èšç„¦ç¼–è¾‘(editorTextFocus)æ—¶ï¼Œæ‰å»æ³¨å†Œçš„æ­¤äº‹ä»¶**ï¼Œæ‡‚ï¼Ÿ

### æºç å±•ç¤º

- [beehive-keybindings.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-keybindings.ts)

## 4.è‡ªå®šä¹‰èœå• Menu

### åœºæ™¯

é€‚ç”¨äºä¸€äº›å¿«æ·æŒ‰é’®çš„è‡ªå®šä¹‰ï¼Œå¯é€šè¿‡ Menu æ“ä½œ

### ä»£ç å±•ç¤º

```typescript
// demo4 è‡ªå®šä¹‰èœå•
import * as vscode from 'vscode'
module.exports = function (context: vscode.ExtensionContext) {
  let disposable = vscode.commands.registerCommand('beehive.customMenu', () => {
    vscode.window.showInformationMessage("I' am custom menu !")
  })
  context.subscriptions.push(disposable)
}
```

```typescript
// extension.ts
import * as vscode from 'vscode'
export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  require('./beehive-customMenu')(context) // demo4 è‡ªå®šä¹‰èœå•
}
export function deactivate() {}
```

```json
// package.json
{
  "activationEvents": ["onCommand:beehive.customMenu"],
  "contributes": {
    "commands": [
      {
        "command": "beehive.customMenu",
        "title": "demo5: å¯åŠ¨è‡ªå®šä¹‰èœå•"
      }
    ],
    "menus": {
      "editor/title": [
        {
          "command": "beehive.customMenu",
          "alt": "beehive.customMenu",
          "group": "navigation"
        }
      ]
    }
  }
}
```

å…³äºè¿™äº›å­—æ®µä¿¡æ¯ï¼Œæˆ‘å°±ä¸ä¸€ä¸€è´´äº†ï¼Œå®˜æ–¹æ–‡æ¡£å¾ˆå¤šè¯´æ˜ï¼Œç›´æ¥çœ‹è¿™é‡Œ: [ğŸ‘‰ æ–‡æ¡£ç›¸å…³å­—æ®µè¯´æ˜](https://code.visualstudio.com/api/references/contribution-points)

### æ•ˆæœå±•ç¤º

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be81fa18178b4280b908edf3d89e4863~tplv-k3u1fbpfcp-watermark.image" width=500 />

ç‚¹å‡»ä¹‹åï¼Œè§¦å‘äº‹ä»¶

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbadce7979a24e0883f4f097444e3d1c~tplv-k3u1fbpfcp-watermark.image" width=500 />

### æºç å±•ç¤º

- [beehive-customMenu.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-customMenu.ts)

## 5.æ‚¬åœæç¤º

### åœºæ™¯

å½“ä½ é¼ æ ‡å…‰æ ‡ hover è‡³æŸä¸ªä»£ç æ—¶ï¼Œä½ æƒ³è¦æ˜¾ç¤ºä¸€äº›æ–‡å­—å†…å®¹

### ä»£ç å±•ç¤º

```typescript
// demo5 å¯¹package.jsonä¸­çš„authorè¿›è¡Œæ‚¬åœæç¤º
import * as vscode from 'vscode'

module.exports = function (context: vscode.ExtensionContext) {
  let disposable = vscode.languages.registerHoverProvider('json', {
    provideHover(document, position, token) {
      const fileName = document.fileName
      const word = document.getText(document.getWordRangeAtPosition(position))
      if (/\/package\.json$/.test(fileName) && /\bauthor\b/.test(word)) {
        return new vscode.Hover('æ‚¬åœæç¤º: å½­é“å®½ç‰›é€¼!')
      }
      return undefined
    },
  })

  context.subscriptions.push(disposable)
}
```

ä¸Šé¢å¯¹äºæ–‡ä»¶ä»¥åŠå…³é”®è¯ keyword å¯ä»¥æ ¹æ®ä¸šåŠ¡è‡ªè¡ŒæŠ½ç¦»ï¼Œè¿™é‡Œå°±ä¸å†™é‚£ä¹ˆå¤šï¼Œè‡ªè¡Œé¢†æ‚Ÿï½

```typescript
// extension.ts
import * as vscode from 'vscode'
export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  require('./beehive-hoverTips')(context) // demo5 æ‚¬åœæç¤º
}
export function deactivate() {}
```

### æ•ˆæœå±•ç¤º

![image](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a590d36dbecd46c38998e8dc5ad8e84b~tplv-k3u1fbpfcp-watermark.image)

### æºç å±•ç¤º

- [beehive-hoverTips.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-hoverTips.ts)

## 6.ä»£ç ç‰‡æ®µ

### åœºæ™¯

è¾“å…¥ä¸€ä¸ªå‰ç¼€ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæç¤ºï¼Œç„¶åå›è½¦å¸¦å‡ºå¾ˆå¤šä»£ç ã€‚

### ä»£ç å±•ç¤º

éœ€è¦ä¿®æ”¹ package.json ä¸­çš„ snippets çš„é…ç½®

```json
// package.json
{
  "contributes": {
    "snippets": [
      {
        "language": "html",
        "path": "./src/snippets/html.json"
      }
    ]
  }
}
```

ç„¶åæ·»åŠ ä¸€ä¸ª html.json é…ç½®

```json
{
  "PDK": {
    "prefix": ["PDK", "PD", "PK", "DK"],
    "body": ["<PDK>", "${1}", "</PDK>"],
    "description": "å½­é“å®½è‡ªå®šä¹‰çš„snippets"
  }
}
```

å…³äºæ¯ä¸ªå­—æ®µï¼Œå¯ä»¥é€šè¿‡å®˜æ–¹æ–‡æ¡£äº†è§£ï¼š[create-your-own-snippets](https://code.visualstudio.com/docs/editor/userdefinedsnippets#_create-your-own-snippets)

ä¸Šé¢æˆ‘ä»¬æ˜¯è®¾ç½®è¯­è¨€ä¸º : **html**ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ’ä»¶ï¼Œå¹¶ä¿è¯æ’ä»¶è¢«æ¿€æ´»ï¼Œåœ¨è§„å®šçš„è¯­è¨€ html ä¸­ï¼Œè¾“å…¥ prefix ç›¸å…³çš„å…³é”®è¯ï¼Œå°±å¯ä»¥å•¦

### æ•ˆæœå±•ç¤º

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80b4c821fc40487282a14ea64e654473~tplv-k3u1fbpfcp-watermark.image" width=300 />

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6b6794936f54ac79592874de68a162f~tplv-k3u1fbpfcp-watermark.image" width=300 />

### æºç å±•ç¤º

- [snippets ä¸­çš„ package é…ç½®](https://github.com/PDKSophia/learn-vscode-extension/blob/master/package.json#L72)

## 7.è‡ªå®šä¹‰ä¾§è¾¹æ +é¢æ¿

### èƒŒæ™¯

éœ€è¦åœ¨å·¦ä¾§è‡ªå®šä¹‰ä¾§è¾¹æ ï¼Œå®Œæˆä¸€äº›äº¤äº’é€»è¾‘æ“ä½œ

### ä»£ç å®ç°

âš ï¸ éœ€è¦æ³¨æ„ï¼š**ä¾§è¾¹æ æŒ‰é’®(Tree View Container)å’Œé¢æ¿è§†å›¾(Tree View)è¦åŒæ—¶é…ç½®ï¼Œå¦åˆ™ä¸ç”Ÿæ•ˆ**

#### ä¾§è¾¹æ çš„å±•ç¤º

é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œçœ‹çœ‹å¦‚ä½•åœ¨å·¦è¾¹è¿™ä¸ªä¾§è¾¹æ æ·»åŠ æˆ‘ä»¬è‡ªå®šä¹‰çš„å†…å®¹

[ğŸ‘‰ contribution-points#contributes.viewsContainers](https://code.visualstudio.com/api/references/contribution-points#contributes.viewsContainers)

```json
// package.json
{
  "contributes": {
    "viewsContainers": {
      "activitybar": [
        {
          "id": "sugar",
          "title": "Sugar-BeeHive",
          "icon": "./src/logo/sugar.svg"
        }
      ]
    },
    "views": {
      "sugar": [
        {
          "id": "BeeHive-Command",
          "name": "01.å‘½ä»¤é›†"
        },
        {
          "id": "BeeHive-PackageAnalysis",
          "name": "02.åŒ…åˆ†æ"
        }
      ]
    }
  }
}
```

âš ï¸ æ³¨æ„ç‚¹ï¼š**views ä¸­ key è¦å’Œ activitybar ä¸­çš„å±æ€§ id ä¿æŒä¸€è‡´ï¼Œå¦‚ sugar åœ¨ä¸¤è€…ä¸­æ˜¯ä¸€è‡´çš„**

è¿™æ—¶å€™è¿è¡Œæˆ‘ä»¬çš„æ’ä»¶ï¼š`Run Extension`ï¼Œå°±å¯ä»¥çœ‹åˆ°åœ¨å·¦ä¾§æœ‰æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¾§è¾¹æ å•¦

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c07922c7cbf142edba76fa30d5a9227a~tplv-k3u1fbpfcp-watermark.image" width=300 />

> å…³äºå›¾æ ‡ svg è¿™ä¸ªå¤§å®¶è‡ªå·±æ³¨æ„ä¸€ä¸‹è·¯å¾„å°±å¥½äº†ï¼Œæˆ‘è¿™è¾¹é‡ç‚¹ä¸æ˜¯å›¾æ ‡å“ˆï½

ä¸Šé¢æˆ‘ä»¬é…ç½®å®Œ `package.json` ä¹‹åï¼Œæˆ‘ä»¬å†å›åˆ°æ–‡æ¡£ï¼Œä¼šçœ‹åˆ°è¿™ä¹ˆä¸€æ®µè¯ï¼š[tree-view#activationEvents](https://code.visualstudio.com/api/extension-guides/tree-view#activation)

å¦‚æœéœ€è¦ï¼Œä½ å°±åŠ ä¸Šä¸‹é¢è¿™æ®µä»£ç å³å¯

```json
{
  "activationEvents": ["onView:BeeHive-Command"]
}
```

#### å¦‚ä½•å®šä¹‰é¢æ¿å†…å®¹

ä¸Šé¢æ˜¯å±•ç¤ºå‡ºæ¥äº†ä¾§è¾¹æ ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å±•ç¤ºå†…å®¹å•Šï¼Œæ€ä¹ˆæ•´ï¼Ÿé€šè¿‡å®˜æ–¹æ–‡æ¡£ï¼š[tree-data-provider](https://code.visualstudio.com/api/extension-guides/tree-view#tree-data-provider) å¯ä»¥å®ç°ä¸€ä¸ªå° demoï¼Œä¸‹é¢è¿™æ®µä»£ç ä¹Ÿæ˜¯åŸºäºå®˜æ–¹æ–‡æ¡£æ”¹çš„

```typescript
// beehive-sidebar.ts
// demo7 è‡ªå®šä¹‰ä¾§è¾¹æ å…¥å£å’Œé¢æ¿
import * as vscode from 'vscode'

const scripts = [
  {
    script: 'webpack:dev',
  },
  {
    script: 'webpack:prod',
  },
  {
    script: 'server:dev',
  },
  {
    script: 'server:test',
  },
  {
    script: 'server:test-1',
  },
  {
    script: 'server:test-2',
  },
]

/**
 * @description é‡å†™æ¯ä¸ªèŠ‚ç‚¹
 */
export class SideBarEntryItem extends vscode.TreeItem {
  constructor(
    private version: string,
    public readonly label: string,
    public readonly collapsibleState: vscode.TreeItemCollapsibleState
  ) {
    super(label, collapsibleState)
    this.tooltip = `${this.label}-${this.version}`
    // this.description = `${this.version}-${Math.ceil(Math.random() * 1000)}`
  }
}

/**
 * @description å…¥å£æ–‡ä»¶
 */
export class SideBarBeeHiveCommand
  implements vscode.TreeDataProvider<SideBarEntryItem> {
  constructor(private workspaceRoot?: string) {}
  getTreeItem(element: SideBarEntryItem): vscode.TreeItem {
    return element
  }

  getChildren(
    element?: SideBarEntryItem
  ): vscode.ProviderResult<SideBarEntryItem[]> {
    if (element) {
      //å­èŠ‚ç‚¹
      var childrenList = []
      for (let index = 0; index < scripts.length; index++) {
        var item = new SideBarEntryItem(
          '1.0.0',
          scripts[index].script,
          vscode.TreeItemCollapsibleState.None
        )
        item.command = {
          command: 'BeeHive-Command.openChild', //å‘½ä»¤id
          title: scripts[index].script,
          arguments: [scripts[index].script], //å‘½ä»¤æ¥æ”¶çš„å‚æ•°
        }
        childrenList[index] = item
      }
      return childrenList
    } else {
      //æ ¹èŠ‚ç‚¹
      return [
        new SideBarEntryItem(
          '1.0.0',
          'é¡¹ç›®ä¸€',
          vscode.TreeItemCollapsibleState.Collapsed
        ),
        new SideBarEntryItem(
          '1.0.0',
          'é¡¹ç›®äºŒ',
          vscode.TreeItemCollapsibleState.Collapsed
        ),
      ]
    }
  }
}

export class SideBarBeeHivePackageAnalysis
  implements vscode.TreeDataProvider<SideBarEntryItem> {
  constructor(private workspaceRoot?: string) {}
  getTreeItem(element: SideBarEntryItem): vscode.TreeItem {
    return element
  }

  getChildren(
    element?: SideBarEntryItem
  ): vscode.ProviderResult<SideBarEntryItem[]> {
    if (element) {
      //å­èŠ‚ç‚¹
      var childrenList = []
      for (let index = 0; index < scripts.length; index++) {
        var item = new SideBarEntryItem(
          '1.0.0',
          scripts[index].script,
          vscode.TreeItemCollapsibleState.None
        )
        item.command = {
          command: 'BeeHive-PackageAnalysis.openChild', //å‘½ä»¤id
          title: scripts[index].script,
          arguments: [index], //å‘½ä»¤æ¥æ”¶çš„å‚æ•°
        }
        childrenList[index] = item
      }
      return childrenList
    } else {
      //æ ¹èŠ‚ç‚¹
      return [
        new SideBarEntryItem(
          '1.0.0',
          'æŒ‰é’®ç»„',
          vscode.TreeItemCollapsibleState.Collapsed
        ),
      ]
    }
  }
}

module.exports = function (context: vscode.ExtensionContext) {
  // æ³¨å†Œä¾§è¾¹æ é¢æ¿
  const sidebarBeeHiveCommand = new SideBarBeeHiveCommand()
  const sidebarBeeHivePackageAnalysis = new SideBarBeeHivePackageAnalysis()
  vscode.window.registerTreeDataProvider(
    'BeeHive-Command',
    sidebarBeeHiveCommand
  )
  vscode.window.registerTreeDataProvider(
    'BeeHive-PackageAnalysis',
    sidebarBeeHivePackageAnalysis
  )

  //æ³¨å†Œå‘½ä»¤
  vscode.commands.registerCommand('BeeHive-Command.openChild', (args) => {
    console.log('[BeeHive-Command.openChild] å½“å‰é€‰ä¸­çš„æ˜¯:', args)
    vscode.window.showInformationMessage(args)
  })
  vscode.commands.registerCommand(
    'BeeHive-PackageAnalysis.openChild',
    (args) => {
      console.log('[BeeHive-PackageAnalysis.openChild] å½“å‰é€‰ä¸­çš„æ˜¯:', args)
      vscode.window.showInformationMessage(args)
    }
  )
}
```

ç„¶ååœ¨å…¥å£æ–‡ä»¶ `extension.ts` æ·»åŠ è¯¥æ–‡ä»¶

```typescript
import * as vscode from 'vscode'

export function activate(context: vscode.ExtensionContext) {
  console.log('your extension "sugar-demo-vscode" is now active!')
  require('./beehive-sidebar')(context) // demo7 è‡ªå®šä¹‰ä¾§è¾¹æ å…¥å£å’Œé¢æ¿
}

export function deactivate() {}
```

å¦‚æœéœ€è¦ç‚¹å‡»å·¦ä¾§ä¾§è¾¹æ çš„èŠ‚ç‚¹æ—¶è§¦å‘å†…å®¹ï¼Œåªéœ€è¦åœ¨ `arguments` é‡Œé¢å›ä¼ ä¸€äº›å†…å®¹ï¼Œç„¶ååšå¯¹åº”çš„ä¸šåŠ¡æ“ä½œå³å¯

### æ•ˆæœå±•ç¤º

![image](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/82c4c91b9d58499a8531bc55bba416b4~tplv-k3u1fbpfcp-watermark.image)

### æºç é˜…è¯»

- [beehive-sidebar.ts](https://github.com/PDKSophia/learn-vscode-extension/blob/master/src/beehive-sidebar.ts)
- [package.json ä¸­çš„ viewsContainers](https://github.com/PDKSophia/learn-vscode-extension/blob/master/package.json#L23)
- [package.json ä¸­çš„ views](https://github.com/PDKSophia/learn-vscode-extension/blob/master/package.json#L32)

## æ‰“åŒ…ã€å‘å¸ƒ

è¿™ä¸œè¥¿å°±ä¸éœ€è¦æˆ‘æ•™äº†å§ï¼Ÿæœä¸€ä¸‹è¿˜æ˜¯æœ‰è¿™æ–¹é¢çš„æ–‡ç« çš„ï¼Œæˆ‘å°±ä¸å½“æ¬è¿å·¥äº†ï¼Œæ„Ÿå…´è¶£çš„è‡ªè¡Œå»æœä¸€æœï¼Œæˆ–è€…ç­‰æˆ‘åç»­å®æˆ˜æ–‡ç« å‡ºæ¥çœ‹çœ‹ï¼Ÿ

# å” å—‘å‡ å¥

ä¸Šé¢çš„å‡ ä¸ªä¾‹å­å·®ä¸å¤šå¤Ÿä¸€ä¸ªæ–°æ‰‹å¼€å‘ vscode æ’ä»¶äº†ï¼Œæ‰€æœ‰çš„ demo ä¾‹å­æˆ‘éƒ½æ”¾åœ¨: [learn-vscode-extension](https://github.com/PDKSophia/learn-vscode-extension)ä¸­ï¼Œåé¢ä¹Ÿä¼šå°†å®æˆ˜çš„é¡¹ç›®è¾…åŠ©å·¥å…·æ’ä»¶æ”¾åœ¨è¯¥ä»“åº“é‡Œ

å¦‚æœä½ å¼€å‘è¿‡vscodeæ’ä»¶ï¼Œä½ å°±çŸ¥é“æ–‡æ¡£å†™çš„æœ‰å¤šâ€œå…¨â€äº†ï¼Œå±äºä½ çŸ¥é“å¾ˆå…¨ï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§æˆ–è€…å­—æ®µåœ¨æ’ä»¶ä¸­é•¿ä»€ä¹ˆæ ·ï¼Œå¾—è‡ªå·±å»â€œæ‚Ÿâ€ï¼Œå¾ˆè›‹ç–¼ï¼Œæˆ‘å¼€å‘è¿‡ç¨‹ï¼Œå¦‚æœéœ€è¦äº›éƒ¨åˆ†çš„æ’ä»¶åŠŸèƒ½ï¼Œå¾—å»æ’ä»¶å¸‚åœºä¸‹è½½å¯¹åº”æ’ä»¶ï¼Œä½¿ç”¨ä¸€æ³¢ï¼Œç„¶åå†å» github é˜…è¯»å¯¹åº”æºç ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ : [vscode-gitlens](https://github.com/eamodio/vscode-gitlens/blob/main/package.json)ç­‰ 

é¡ºä¾¿æ¾„æ¸…ä¸€ä¸‹ï¼Œç»„å‘˜ä¸ç”¨ PC ç«¯çš„é¡¹ç›®è¾…åŠ©å·¥å…·çœŸçš„ä¸æ˜¯æˆ‘å†™çš„çƒ‚!!!

è´´å‡ å¼ å›¾çœ‹çœ‹ PC ç«¯çš„é¡¹ç›®è¾…åŠ©å·¥å…·ï¼Œä¼šå°†ä¸Šè¾¹çš„åŠŸèƒ½éƒ½ç»§æ‰¿åˆ°è¯¥ vscode æ’ä»¶ä¸­ï¼Œåé¢ PC ç«¯çš„ä»£ç  + vscode æ’ä»¶ä»£ç éƒ½ä¼šè„±æ•å¼€æºï½

1. å…¥å£

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ce0f952f5184415a9d745e22e1f25af~tplv-k3u1fbpfcp-watermark.image"  >

2. å¯¼å…¥æ–‡ä»¶ï¼Œå†å²æ“ä½œåŒº

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81f8d87561d34b558ba179c60274f7cd~tplv-k3u1fbpfcp-watermark.image" >

3. å¯¼å…¥çš„æ–‡ä»¶ä¸ç¬¦åˆè§„èŒƒ

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5380da60466e4040885559962c05c213~tplv-k3u1fbpfcp-watermark.image" >

4. ç¬¦åˆè§„èŒƒï¼Œè¿è¡Œå‘½ä»¤ï¼Œæ–‡ç« æ£€ç´¢

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b5d5265f586743e59d168eb8bd7cc621~tplv-k3u1fbpfcp-watermark.image" >

å¤ªå¤šå †ç§¯æ–‡ç« éœ€è¦å†™äº†ï¼Œç­‰è¿‡å®Œå¹´å†æ…¢æ…¢æ•´ç†å§ï¼Œç¥å¤§å®¶è¿‡ä¸ªå¥½å¹´

# ç›¸å…³é“¾æ¥

- [é˜¿å®½çš„åšå®¢](https://github.com/PDKSophia/blog.io)
- [SugarTurboS](https://github.com/SugarTurboS)
- [vscode-gitlens](https://github.com/eamodio/vscode-gitlens/blob/main/package.json)
- [å®˜æ–¹æ–‡æ¡£API](https://code.visualstudio.com/api/references/vscode-api)
- [å°èŒ—åŒå­¦-vscodeæ’ä»¶å¼€å‘å…¨æ”»ç•¥](https://www.cnblogs.com/liuxianan/p/vscode-plugin-overview.html)

> å¤¸ä¸€ä¸‹å°èŒ—åŒå­¦çš„æ–‡ç« ï¼Œè™½ç„¶æˆ‘æ²¡æ€ä¹ˆè®¤çœŸçœ‹å†…å®¹ï¼Œæˆ‘éƒ½æ˜¯çœ‹å›¾ï¼Œç„¶åå»çœ‹è¯¥å›¾å¯¹åº”çš„æºç ï¼Œä¸è¿‡åœ¨å‰æœŸå¼€å‘vscodeæ’ä»¶ï¼Œå¯ä»¥è¯´å¸®åŠ©è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï½